# åœºæ™¯æ ¼å¼æ’ä»¶ - å®Œæ•´é¢„è®¾ä½¿ç”¨è¯´æ˜

## ğŸ“Œ æ›´æ–°è¯´æ˜

æ’ä»¶å·²å‡çº§ï¼Œç°åœ¨å¯ä»¥**å®Œæ•´ä½¿ç”¨é¢„è®¾çš„æ‰€æœ‰å†…å®¹**ï¼Œè€Œä¸ä»…ä»…æ˜¯æ–‡é£ï¼

### å‡çº§å‰ vs å‡çº§å

| åŠŸèƒ½ | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ï¼ˆå½“å‰ï¼‰ |
|------|--------|-------------|
| ä¸»æç¤º (main) | âŒ ä¸ä½¿ç”¨ | âœ… **ä½¿ç”¨** |
| æŒ‡å— (Zhinan) | âŒ ä¸ä½¿ç”¨ | âœ… **ä½¿ç”¨** |
| ç¦è¯è¡¨ | âŒ ä¸ä½¿ç”¨ | âœ… **ä½¿ç”¨** |
| æ–‡é£ Prompts | âœ… ä½¿ç”¨ | âœ… ä½¿ç”¨ |
| å…¶ä»–è´¨é‡æ§åˆ¶è§„åˆ™ | âŒ ä¸ä½¿ç”¨ | âœ… **ä½¿ç”¨** |

## ğŸ¯ å®Œæ•´é¢„è®¾åŠŸèƒ½

### 1. é¢„è®¾å†…å®¹çš„å±‚çº§åº”ç”¨

å½“æ‚¨å¯¼å…¥å¹¶æ¿€æ´»é¢„è®¾åï¼Œåœºæ™¯ç”Ÿæˆæ—¶ä¼šæŒ‰ä»¥ä¸‹å±‚çº§ç»„è£… Promptï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ä¸»æç¤ºå±‚ (Main)                          â”‚
â”‚    - å®šä¹‰ AI èº«ä»½å’Œä»»åŠ¡                     â”‚
â”‚    - æ¥è‡ªé¢„è®¾çš„ "main" prompt               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. è§’è‰²ä¿¡æ¯å±‚                                â”‚
â”‚    - Bot äººè®¾ã€æ€§æ ¼ã€å›å¤é£æ ¼               â”‚
â”‚    - æ¥è‡ª MaiBot çš„é…ç½®æ–‡ä»¶                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. åœºæ™¯ä»»åŠ¡å±‚                                â”‚
â”‚    - å½“å‰åœºæ™¯çŠ¶æ€ã€æ—¥ç¨‹ä¿¡æ¯                 â”‚
â”‚    - ç”¨æˆ·æ¶ˆæ¯ã€çŠ¶æ€å†³ç­–                     â”‚
â”‚    - æ’ä»¶è‡ªåŠ¨ç”Ÿæˆ                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. å†™ä½œè§„åˆ™å±‚                                â”‚
â”‚    - æŒ‡å— (Zhinan) - æœ€é«˜æ‰®æ¼”è§„åˆ™          â”‚
â”‚    - ç¦è¯è¡¨ - é¿å…é™ˆè¯æ»¥è°ƒ                  â”‚
â”‚    - æ¥è‡ªé¢„è®¾çš„è´¨é‡æ§åˆ¶ prompts             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. æ–‡é£å±‚                                    â”‚
â”‚    - æ¿€æ´»çš„æ–‡é£è§„åˆ™                         â”‚
â”‚    - æ¥è‡ªé¢„è®¾çš„æ–‡é£ prompts                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. è¾“å‡ºæ ¼å¼å±‚                                â”‚
â”‚    - JSON æ ¼å¼è¦æ±‚                          â”‚
â”‚    - æ’ä»¶è‡ªåŠ¨æ·»åŠ                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. é¢„è®¾ä¸­å„ç±» Prompts çš„ä½œç”¨

#### **ä¸»æç¤º (Main)**
- **Identifier**: `main`
- **ä½œç”¨**: å®šä¹‰ AI çš„åŸºæœ¬èº«ä»½å’Œå†™ä½œè§’è‰²
- **ç¤ºä¾‹**ï¼ˆæ¥è‡ª Izumi é¢„è®¾ï¼‰:
  ```
  [Task]
  ä½ æ˜¯Konata,ä¸€ä¸ªæ•…äº‹åˆ›ä½œè€…ã€‚
  [/Task]
  ```

#### **æŒ‡å— (Zhinan)**
- **åç§°åŒ…å«**: "æŒ‡å—" æˆ– "Zhinan"
- **ä½œç”¨**: æœ€é«˜æ‰®æ¼”è§„åˆ™ï¼Œé¿å…å¤§æ¨¡å‹æ€ç»´å®šåŠ¿
- **åŒ…å«å†…å®¹**:
  - æ‹’ç»é¦–å¥æ¯”å–»
  - æ‹’ç»å…«å›½è”å†›ï¼ˆåªç”¨ç®€ä½“ä¸­æ–‡ï¼‰
  - æ´»äººæ„Ÿï¼ˆç”Ÿæ´»åŒ–å¯¹ç™½ï¼‰
  - é˜²ç¬¦å·æ»¥ç”¨
  - ä½œè€…å·²æ­»ï¼ˆä¸æ’å…¥ä¸»è§‚çœ‹æ³•ï¼‰
  - åç›´è§‰ï¼ˆæ‰“ç ´æ€ç»´å®šåŠ¿ï¼‰

#### **ç¦è¯è¡¨**
- **åç§°åŒ…å«**: "ç¦è¯è¡¨" æˆ– "ç¦è¯"
- **ä½œç”¨**: æ˜ç¡®åˆ—å‡ºç¦æ­¢ä½¿ç”¨çš„é™ˆè¯æ»¥è°ƒ
- **ç¤ºä¾‹**:
  ```
  å£°éŸ³ã€å—“éŸ³ã€ä¸€ä¸ã€å¸¦ç€ä¸€ä¸ã€ä¸å®¹ç½®ç–‘ã€
  æ²™å“‘ã€ç£æ€§ã€å¾æœã€æ”¯é…ã€æ·±æ¸Šã€é¢¤æŠ–ã€
  å°å…½ã€ç»æœ›ã€çœ¼ç¥ç©ºæ´ã€æ¶Ÿæ¼ªã€éª¨èŠ‚æ³›ç™½...
  ```

#### **æ–‡é£ Prompts**
- **åç§°åŒ…å«**: "âœ”ï¸" æˆ– "æ–‡é£" æˆ–ç‰¹å®šå…³é”®è¯
- **ä½œç”¨**: å…·ä½“çš„å†™ä½œé£æ ¼æŒ‡å¯¼
- **å¯ç”¨æ–‡é£**ï¼ˆIzumi é¢„è®¾ç¤ºä¾‹ï¼‰:
  - âœ”ï¸ç”µç«è§£è¯´é£æ ¼
  - âœ”ï¸ä¼è§å¸é£æ ¼ï¼ˆé’æ˜¥å–œå‰§ï¼‰
  - âœ”ï¸ä¼˜ç¾æ•£æ–‡ï¼ˆæ²ˆä»æ–‡ï¼‰
  - âœ”ï¸é•°æ± å’Œé©¬é£æ ¼
  - âœ”ï¸è¯šå®èˆå°ï¼ˆé›¶åº¦èˆå°ï¼‰
  - âœ”ï¸éº»æå‡†é£æ ¼ï¼ˆKeyç¤¾å‚¬æ³ªï¼‰

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•ä¸€ï¼šå¯¼å…¥é¢„è®¾å¹¶æ¿€æ´»æ–‡é£ï¼ˆæ¨èï¼‰

```bash
# 1. å¯¼å…¥é¢„è®¾
/scene preset import Izumié¢„è®¾V0.2.json

# 2. æŸ¥çœ‹å¯ç”¨æ–‡é£
/scene preset list

# 3. æ¿€æ´»æ–‡é£ï¼ˆä¼šè‡ªåŠ¨åº”ç”¨å®Œæ•´é¢„è®¾ï¼‰
/scene preset use 2dbec179-06c2-4d22-80d8-1d0d9649ef72

# 4. ç”Ÿæˆæ—¥ç¨‹
/åœºæ™¯æ—¥ç¨‹

# 5. å¯åŠ¨åœºæ™¯æ¨¡å¼
/scene on
```

### æ–¹æ³•äºŒï¼šä»…ä½¿ç”¨é¢„è®¾çš„è´¨é‡æ§åˆ¶è§„åˆ™ï¼ˆä¸ä½¿ç”¨æ–‡é£ï¼‰

å¦‚æœæ‚¨ä¸æƒ³ä½¿ç”¨æ–‡é£ï¼Œå¯ä»¥ä¿®æ”¹ä»£ç ä¸­çš„å‚æ•°ï¼š

```python
# åœ¨ scene_handler.py å’Œ scene_command.py ä¸­ä¿®æ”¹ä¸ºï¼š
enhanced_prompt = self.preset_manager.build_full_preset_prompt(
    base_prompt=prompt,
    include_main=True,       # åŒ…å«ä¸»æç¤º
    include_guidelines=True, # åŒ…å«æŒ‡å—å’Œç¦è¯è¡¨
    include_style=False      # ä¸åŒ…å«æ–‡é£
)
```

### æ–¹æ³•ä¸‰ï¼šå®Œå…¨è‡ªå®šä¹‰

```python
# å®Œå…¨è‡ªå®šä¹‰å“ªäº›éƒ¨åˆ†å¯ç”¨
enhanced_prompt = self.preset_manager.build_full_preset_prompt(
    base_prompt=prompt,
    include_main=False,      # ä¸åŒ…å«ä¸»æç¤º
    include_guidelines=True, # åŒ…å«æŒ‡å—å’Œç¦è¯è¡¨
    include_style=True       # åŒ…å«æ–‡é£
)
```

## ğŸ” éªŒè¯é¢„è®¾æ˜¯å¦æ­£ç¡®åº”ç”¨

### æŸ¥çœ‹æ—¥å¿—

å¯åŠ¨åœºæ™¯æ—¶ï¼Œæ—¥å¿—ä¸­ä¼šæ˜¾ç¤ºï¼š

```
[preset_manager] å·²æ·»åŠ ä¸»æç¤º
[preset_manager] å·²æ·»åŠ  1 ä¸ªæŒ‡å—è§„åˆ™
[preset_manager] å·²æ·»åŠ ç¦è¯è¡¨
[preset_manager] å·²æ·»åŠ æ–‡é£ 'âœ”ï¸æ–‡é£-ç”µç«è§£è¯´ï¼ˆèƒ½æ€å…«è‚¡ï¼‰'
[preset_manager] å·²æ„å»ºå®Œæ•´é¢„è®¾ promptï¼ŒåŒ…å« 5 ä¸ªéƒ¨åˆ†
```

### å¯¹æ¯”æ•ˆæœ

**æœªåº”ç”¨é¢„è®¾**ï¼ˆæ—§ç‰ˆæœ¬ï¼‰:
- å¯èƒ½åŒ…å«"ä¸€ä¸"ã€"å¸¦ç€"ç­‰ç¦ç”¨è¯æ±‡
- å¯èƒ½å‡ºç°å…«è‚¡æ–‡è¡¨è¾¾
- ç¼ºä¹ç»Ÿä¸€çš„å†™ä½œé£æ ¼

**åº”ç”¨å®Œæ•´é¢„è®¾**ï¼ˆæ–°ç‰ˆæœ¬ï¼‰:
- ä¸¥æ ¼é¿å…ç¦è¯è¡¨ä¸­çš„è¯æ±‡
- éµå¾ªæŒ‡å—ä¸­çš„æ‰®æ¼”è§„åˆ™
- ç¬¦åˆé€‰å®šçš„æ–‡é£ç‰¹ç‚¹
- æ•´ä½“è´¨é‡æ›´é«˜ã€æ›´ç»Ÿä¸€

## âš™ï¸ é«˜çº§é…ç½®

### æ–°å¢çš„ PresetManager æ–¹æ³•

#### `build_full_preset_prompt()`
å®Œæ•´çš„é¢„è®¾åº”ç”¨æ–¹æ³•ï¼Œæ”¯æŒçµæ´»æ§åˆ¶ï¼š

```python
def build_full_preset_prompt(
    self,
    base_prompt: str,           # åŸºç¡€ prompt
    include_main: bool = True,  # æ˜¯å¦åŒ…å«ä¸»æç¤º
    include_guidelines: bool = True,  # æ˜¯å¦åŒ…å«æŒ‡å—å’Œç¦è¯è¡¨
    include_style: bool = True  # æ˜¯å¦åŒ…å«æ–‡é£
) -> str:
```

#### `get_preset_prompt_by_identifier()`
è·å–ç‰¹å®š identifier çš„ promptï¼š

```python
content = preset_manager.get_preset_prompt_by_identifier("Izumié¢„è®¾V0.2", "main")
```

#### `get_preset_prompts_by_name_pattern()`
æ ¹æ®åç§°æ¨¡å¼æ‰¹é‡è·å– promptsï¼š

```python
guidelines = preset_manager.get_preset_prompts_by_name_pattern(
    "Izumié¢„è®¾V0.2",
    ["æŒ‡å—", "Zhinan"]
)
```

## ğŸ“Š è´¨é‡æå‡æ•ˆæœ

### é¢„è®¾å¸¦æ¥çš„æ”¹è¿›

1. **é¿å…AIå…«è‚¡æ–‡**
   - é€šè¿‡"æŒ‡å—"è§„åˆ™é¿å…å¸¸è§çš„AIå†™ä½œé—®é¢˜
   - é€šè¿‡"ç¦è¯è¡¨"æœç»é™ˆè¯æ»¥è°ƒ

2. **ç»Ÿä¸€å†™ä½œé£æ ¼**
   - ä¸»æç¤ºå®šä¹‰åŸºæœ¬åˆ›ä½œè§’è‰²
   - æ–‡é£è§„åˆ™æä¾›å…·ä½“å†™ä½œæŒ‡å¯¼

3. **æå‡çœŸå®æ„Ÿ**
   - æŒ‡å—å¼ºè°ƒ"æ´»äººæ„Ÿ"å’Œç”Ÿæ´»åŒ–å¯¹ç™½
   - é¿å…æœºæ¢°åŒ–ã€æ•°æ®åŒ–çš„è¡¨è¾¾

4. **çµæ´»å¯æ§**
   - å¯é€‰æ‹©æ˜¯å¦åº”ç”¨å„ä¸ªå±‚çº§
   - å¯éšæ—¶åˆ‡æ¢ä¸åŒæ–‡é£

## ğŸ¨ åˆ›å»ºè‡ªå®šä¹‰é¢„è®¾

æ‚¨ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„é¢„è®¾ JSON æ–‡ä»¶ï¼Œåªéœ€éµå¾ª SillyTavern é¢„è®¾æ ¼å¼ï¼š

```json
{
  "temperature": 1.5,
  "top_p": 0.98,
  "prompts": [
    {
      "name": "ä¸»æç¤º",
      "identifier": "main",
      "role": "system",
      "content": "ä½ çš„ä¸»æç¤ºå†…å®¹...",
      "system_prompt": true
    },
    {
      "name": "æŒ‡å—ï¼ˆä¸èƒ½å…³ï¼‰",
      "identifier": "your-uuid",
      "role": "system",
      "content": "æ‚¨çš„æŒ‡å—è§„åˆ™...",
      "system_prompt": false
    },
    {
      "name": "âœ”ï¸æ–‡é£-è‡ªå®šä¹‰",
      "identifier": "your-style-uuid",
      "role": "system",
      "content": "<writing_style>\næ‚¨çš„æ–‡é£è§„åˆ™...\n</writing_style>",
      "system_prompt": false
    }
  ]
}
```

## ğŸ§© è‡ªå®šä¹‰é¢„è®¾å¯¼å…¥è§„åˆ™

ä¸åŒä½œè€…çš„ SillyTavern é¢„è®¾å‘½åæ–¹å¼å·®å¼‚å¾ˆå¤§ã€‚ä¸ºäº†é¿å…æ¯æ¬¡éƒ½ä¿®æ”¹ä»£ç ï¼Œæ’ä»¶æ–°å¢äº† `data/preset_import_config.json`ï¼Œå…è®¸ä½ ä¸ºä»»æ„é¢„è®¾åˆ›å»ºè‡ªå®šä¹‰è§£ææ¡£æ¡ˆã€‚

### é…ç½®ç»“æ„

```jsonc
{
  "profiles": {
    "default": { ... é€šç”¨è§„åˆ™ ... },
    "english_pack": {
      "prompt_keys": ["custom.prompts"],
      "prompt_order_character_ids": [200001],
      "prompt_order_use_first": true,
      "main_identifiers": ["main", "core_main"],
      "style_detection": {
        "name_keywords": ["Style", "Voice"],
        "identifier_prefixes": ["style_"]
      },
      "guideline_detection": {
        "name_keywords": ["Guide", "Rules"]
      },
      "forbidden_detection": {
        "name_keywords": ["Banlist", "Forbidden"]
      }
    }
  },
  "preset_profiles": {
    "Izumié¢„è®¾V0.2": "default",
    "MyEnglishPreset": "english_pack"
  }
}
```

- `profiles`ï¼šæè¿°ä¸€ç±»é¢„è®¾çš„è§£ææ–¹å¼ã€‚æœªé…ç½®çš„å­—æ®µä¼šç»§æ‰¿ `default`ã€‚
  - `prompt_keys`ï¼šå€™é€‰å­—æ®µè·¯å¾„ï¼ˆæ”¯æŒç‚¹å·è¡¨è¾¾å¼ï¼‰ç”¨æ¥å¯»æ‰¾ `prompts`ã€‚
  - `prompt_order_keys`/`prompt_order_character_ids`ï¼šå†³å®šä½¿ç”¨å“ªä¸ª `prompt_order` é…ç½®ã€‚
  - `prompt_order_use_first`ï¼šè‹¥æ‰¾ä¸åˆ°åŒ¹é…çš„ character_id æ˜¯å¦é€€å›åˆ°ç¬¬ä¸€ä¸ªé…ç½®ã€‚
  - `main_identifiers`ï¼šå“ªäº› identifier è¢«è§†ä¸ºä¸»æç¤ºã€‚
  - `ignore_identifiers`ï¼šæ°¸è¿œä¸ä¼šå‚ä¸ç»„è£…çš„ç³»ç»Ÿæ®µã€‚
  - `style_detection` / `guideline_detection` / `forbidden_detection`ï¼š
    - `name_keywords`ï¼šåç§°åŒ…å«è¿™äº›å…³é”®è¯å³åŒ¹é…ã€‚
    - `identifier_*`ï¼šé€šè¿‡ identifier å‰ç¼€/åç¼€/ç™½åå•åˆ¤æ–­ã€‚
    - å…³é”®å­—å¤§å°å†™ä¸æ•æ„Ÿã€‚
- `preset_profiles`ï¼šæŠŠå…·ä½“çš„é¢„è®¾åç§°ï¼ˆç­‰åŒäºæ–‡ä»¶åå»æ‰æ‰©å±•åï¼‰æ˜ å°„åˆ°æŸä¸ª profileã€‚

### è‡ªå®šä¹‰æµç¨‹

1. æ‰“å¼€/æ–°å»º `data/preset_import_config.json`ã€‚
2. å¦‚æœå¤šä¸ªé¢„è®¾å…±ç”¨åŒä¸€è§„åˆ™ï¼Œå¯åœ¨ `profiles` ä¸‹å®šä¹‰ä¸€ä¸ªæ–°çš„ profileï¼Œå¹¶åœ¨ `preset_profiles` ä¸­æ ‡è®°éœ€è¦ä½¿ç”¨å®ƒçš„é¢„è®¾åã€‚
3. å¦‚æœåªæœ‰å•ä¸ªé¢„è®¾éœ€è¦ç‰¹æ®ŠåŒ¹é…ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨ `profiles` ä¸­åˆ›å»ºä¸€ä¸ªåªæœåŠ¡è¯¥é¢„è®¾çš„ profileã€‚
4. ä¿å­˜æ–‡ä»¶åé‡æ–°å¯¼å…¥é¢„è®¾å³å¯ç”Ÿæ•ˆï¼ˆæ— éœ€é‡å¯æœåŠ¡ï¼‰ã€‚

é€šè¿‡è¯¥é…ç½®ï¼Œä½ å¯ä»¥ï¼š

- ä¸ºè‹±æ–‡æˆ–æ—¥æ–‡å‘½åçš„æ–‡é£/æŒ‡å—æ·»åŠ è‡ªå®šä¹‰å…³é”®è¯ï¼›
- æŒ‡å®šå¤šä¸ª `prompt_order` é…ç½®ä¸­çš„å“ªä¸€ä¸ªæ‰æ˜¯ä½ éœ€è¦çš„é¡ºåºï¼›
- ä¿®æ”¹ä¸»æç¤º identifierï¼ˆä¾‹å¦‚æŸäº›é¢„è®¾ç”¨ `core_main`ï¼‰ï¼›
- ä¸ºå®Œå…¨ä¸åŒç»“æ„çš„ JSON æŒ‡å‡º `prompts` / `prompt_order` çš„å‡†ç¡®è·¯å¾„ï¼›
- ç¦æ­¢æŸäº›ç³»ç»Ÿå±‚æ®µè¢«è¯¯åˆ¤ä¸ºæ–‡é£ã€‚

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šé¢„è®¾æœªç”Ÿæ•ˆ

**æ£€æŸ¥æ­¥éª¤**:
1. ç¡®è®¤é¢„è®¾å·²å¯¼å…¥: `/scene preset list`
2. ç¡®è®¤æ–‡é£å·²æ¿€æ´»: `/scene preset status`
3. æŸ¥çœ‹æ—¥å¿—ä¸­æ˜¯å¦æœ‰ "å·²æ„å»ºå®Œæ•´é¢„è®¾ prompt"

### é—®é¢˜2ï¼šæ‰¾ä¸åˆ°æŒ‡å—æˆ–ç¦è¯è¡¨

**åŸå› **: é¢„è®¾ä¸­çš„ prompt åç§°ä¸åŒ…å« "æŒ‡å—"ã€"Zhinan" æˆ– "ç¦è¯è¡¨" å…³é”®è¯

**è§£å†³æ–¹æ¡ˆ**: ä¿®æ”¹ `preset_manager.py` ä¸­çš„åŒ¹é…æ¨¡å¼ï¼Œæˆ–é‡å‘½åé¢„è®¾ä¸­çš„ prompts

### é—®é¢˜3ï¼šæƒ³ä¸´æ—¶ç¦ç”¨æŸäº›è§„åˆ™

**æ–¹æ³•**: ä¿®æ”¹ `build_full_preset_prompt()` çš„å‚æ•°ï¼š

```python
# åªä½¿ç”¨æ–‡é£ï¼Œä¸ä½¿ç”¨å…¶ä»–è§„åˆ™
enhanced_prompt = self.preset_manager.build_full_preset_prompt(
    base_prompt=prompt,
    include_main=False,
    include_guidelines=False,
    include_style=True
)
```

## ğŸ“ æ€»ç»“

ç°åœ¨æ’ä»¶èƒ½å¤Ÿ**å®Œæ•´åˆ©ç”¨é¢„è®¾çš„æ‰€æœ‰å†…å®¹**ï¼ŒåŒ…æ‹¬ï¼š

âœ… **ä¸»æç¤º** - å®šä¹‰ AI èº«ä»½
âœ… **æŒ‡å—** - é¿å…AIå…«è‚¡æ–‡
âœ… **ç¦è¯è¡¨** - æœç»é™ˆè¯æ»¥è°ƒ
âœ… **æ–‡é£** - ç»Ÿä¸€å†™ä½œé£æ ¼

è¿™ä½¿å¾—åœºæ™¯ç”Ÿæˆçš„è´¨é‡å¤§å¤§æå‡ï¼ŒåŒæ—¶ä¿æŒäº†é«˜åº¦çš„çµæ´»æ€§å’Œå¯æ§æ€§ã€‚
